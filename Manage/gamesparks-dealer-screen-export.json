{"screens":{"DSlotCtrl":{"shortCode":"DSlotCtrl","name":"Dealership slot control","html":"<gs-title-block padding=\"5\" margin=\"1\" title=\"Dealership Controls\">\n    <gs-title-block padding=\"5\" margin=\"1\" title=\"Global Settings\">\n        <gs-row>\n            <gs-snippet snippet=\"SetDSCache\"></gs-snippet>\n        </gs-row>\n    </gs-title-block>\n    \n    <gs-placeholder id=\"ranges_target\" >\n        <gs-title-block padding=\"5\" margin=\"1\" title=\"Class/Rarity Ranges\">\n            <gs-row>\n                <gs-snippet snippet=\"GetDSCRRanges\"></gs-snippet>\n            </gs-row>\n        </gs-title-block>\n        \n        <gs-title-block padding=\"5\" margin=\"1\" title=\"Variant Keys\">\n            <gs-row>\n                <gs-snippet snippet=\"GetVariantKeys\"></gs-snippet>\n            </gs-row>\n        </gs-title-block>\n    </gs-placeholder>\n    \n</gs-titile-block>","allowedGroups":"gameAdmin"}},"snippets":{"GetDSCRRanges":{"template":"<gs-col>\n    {{#each Ranges}}\n    <gs-row>\n        <gs-col width=\"6\" align=\"right\">\n            {{key}}:\n        </gs-col>\n        <gs-col width=\"6\" align=\"left\">\n            {{value}}\n        </gs-col>\n    </gs-row>\n    {{/each}}\n</gs-col>","script":"var redis = Spark.getRedis();\nvar classes = [\"ClassC\", \"ClassB\", \"ClassA\", \"ClassS\"];\nvar rarities = [\"Common\", \"Uncommon\", \"Rare\", \"Legendary\"];\n\nvar ranges = [];\nfor (var i = 0; i < classes.length; i++) {\n    for (var j = 0; j < rarities.length; j++) {\n        var key = classes[i] + \".\" + rarities[j] + \"Range\";\n        ranges.push({ \"key\" : key, \"value\" : redis.get(key) });\n    }\n}\n\nSpark.setScriptData(\"Ranges\", ranges);  ","shortCode":"GetDSCRRanges","name":"Dealership: Get dealership class rarity ranges","allowedGroups":""},"GetNumSlots":{"template":"<gs-col>\n    <gs-row>\n        <gs-col width=\"6\" align=\"right\">\n            Default number of slots:\n        </gs-col>\n        <gs-col width=\"6\" align=\"left\">\n            {{NumDealerSlots}}\n        </gs-col>\n    </gs-row>\n</gs-col>","script":"var numSlots = 12;\nvar redis = Spark.getRedis();\nvar redisSlots = redis.get(\"NumDealerSlots\");\nif (typeof(redisSlots) !== undefined \n    && redisSlots !== undefined\n    && redisSlots !== \"undefined\"\n    && redisSlots !== null) {\n   numSlots = redisSlots;\n}\n    \nSpark.setScriptData(\"NumDealerSlots\", numSlots);  \n","shortCode":"GetNumSlots","name":"Dealership: Get default number of dealership slots","allowedGroups":""},"GetVariantKeys":{"template":"<gs-col>\n    {{#each Keys}}\n    <gs-row>\n        <gs-col width=\"6\" align=\"right\">\n            {{key}}:\n        </gs-col>\n        <gs-col width=\"6\" align=\"left\">\n            {{value}}\n        </gs-col>\n    </gs-row>\n    {{/each}}\n</gs-col>","script":"var redis = Spark.getRedis();\nvar classes = [\"ClassC\", \"ClassB\", \"ClassA\", \"ClassS\"];\nvar rarities = [\"Common\", \"Uncommon\", \"Rare\", \"Legendary\"];\n\nvar keys = [];\nfor (var i = 0; i < classes.length; i++) {\n    for (var j = 0; j < rarities.length; j++) {\n        var rangeKey = classes[i] + \".\" + rarities[j] + \"Range\";\n        var range = redis.get(rangeKey);\n        var rangeInt = parseInt(range);\n        if (!isNaN(rangeInt)) {\n            for (var k = 1; k <= range; k++) {\n                var variantKey = classes[i] + \".\" + rarities[j] + \".\" + k.toString();\n                keys.push({ \"key\" : variantKey, \"value\" : redis.get(variantKey) });\n            }\n        }\n    }\n}\n\nSpark.setScriptData(\"Keys\", keys);  ","shortCode":"GetVariantKeys","name":"Dealership: Get dealership variant cache keys","allowedGroups":""},"SetDSCache":{"template":"<gs-form snippet=\"SetDSCache\" target=\"ranges_target\">\n    <gs-row>\n        <gs-col width=\"6\" align=\"right\">\n            Recalculate cache ranges:\n        </gs-col>\n        <gs-col width=\"6\" align=\"left\">\n            <gs-submit>Submit</gs-submit>\n        </gs-col>\n    </gs-row>    \n</gs-form>","script":"Spark.setScriptData(\"start\", []);\n\nrequire(\"DealershipManager\");\nrequire(\"GeneralUtilities\");\n\nSpark.getLog().info(\"PRESSED BUTTON IN DEALERSHIP SLOT CONTROL RecalculateDealershipCacheValues() STARTED\");\n\nRecalculateDealershipCachedValues();\n\nSpark.getLog().info(\"PRESSED BUTTON IN DEALERSHIP SLOT CONTROL RecalculateDealershipCacheValues() FINISHED\");\n\nSpark.setScriptData(\"end\", []);","shortCode":"SetDSCache","name":"Dealership: Sets dealership cache","allowedGroups":""}},"queries":{},"displayName":null,"shortCode":null}